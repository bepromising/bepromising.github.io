(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0d6a8843"],{"053b":function(e,t,r){},"416d":function(e,t,r){"use strict";t["a"]="./Tree.vue"},"5d6b":function(e,t,r){var n=r("e53d").parseInt,a=r("a1ce").trim,s=r("e692"),o=/^[-+]?0[xX]/;e.exports=8!==n(s+"08")||22!==n(s+"0x16")?function(e,t){var r=a(String(e),3);return n(r,t>>>0||(o.test(r)?16:10))}:n},"60ce":function(e,t,r){"use strict";var n=r("053b"),a=r.n(n);a.a},7445:function(e,t,r){var n=r("63b6"),a=r("5d6b");n(n.G+n.F*(parseInt!=a),{parseInt:a})},"7c9b":function(e,t,r){"use strict";function n(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n in e)e.hasOwnProperty(n)&&-1===r.indexOf(n)&&(e[n]=t);return e}function a(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r in e)e.hasOwnProperty(r)&&(e[r]=t[r]);return e}r.d(t,"a",function(){return n}),r.d(t,"b",function(){return a})},a1ce:function(e,t,r){var n=r("63b6"),a=r("25eb"),s=r("294c"),o=r("e692"),c="["+o+"]",i="​",l=RegExp("^"+c+c+"*"),u=RegExp(c+c+"*$"),d=function(e,t,r){var a={},c=s(function(){return!!o[e]()||i[e]()!=i}),l=a[e]=c?t(p):o[e];r&&(a[r]=l),n(n.P+n.F*c,"String",a)},p=d.trim=function(e,t){return e=String(a(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(u,"")),e};e.exports=d},b14e:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"subpage--main"},[r("Card",[r("div",{staticClass:"condition"},[r("label",{staticClass:"condition__item"},[e._v("\r\n        角色名称：\r\n        "),r("Input",{staticClass:"input",attrs:{placeholder:"请输入角色名称"},model:{value:e.table.unsyncQuery.name,callback:function(t){e.$set(e.table.unsyncQuery,"name",t)},expression:"table.unsyncQuery.name"}})],1),r("label",{staticClass:"condition__item"},[e._v("\r\n        角色代号：\r\n        "),r("Input",{staticClass:"input",attrs:{placeholder:"请输入角色代号"},model:{value:e.table.unsyncQuery.code,callback:function(t){e.$set(e.table.unsyncQuery,"code",t)},expression:"table.unsyncQuery.code"}})],1),r("div",{staticClass:"condition__submit"},[r("Button",{attrs:{type:"info",shape:"circle",icon:"ios-search"},on:{click:e.table.apply}},[e._v("查询")]),r("Button",{attrs:{type:"primary",shape:"circle",icon:"person-add"},on:{click:e.addRole}},[e._v("新增")])],1)]),r("EasyTable",{attrs:{table:e.table,stripe:""}})],1),r("Modal",{attrs:{title:e.roleModal.title},on:{"on-ok":e.save},model:{value:e.roleModal.show,callback:function(t){e.$set(e.roleModal,"show",t)},expression:"roleModal.show"}},[r("Form",{ref:"roleForm",attrs:{model:e.roleForm,rules:e.roleValidate,"label-width":120}},[e.roleModal.edit?r("FormItem",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"角色ID",prop:"roleID"}},[r("Input",{model:{value:e.roleForm.roleID,callback:function(t){e.$set(e.roleForm,"roleID",t)},expression:"roleForm.roleID"}})],1):e._e(),r("FormItem",{attrs:{label:"角色名称",prop:"name"}},[r("Input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.roleForm.name,callback:function(t){e.$set(e.roleForm,"name",t)},expression:"roleForm.name"}})],1),r("FormItem",{attrs:{label:"角色代号",prop:"code"}},[r("Input",{attrs:{placeholder:"请输入角色代号"},model:{value:e.roleForm.code,callback:function(t){e.$set(e.roleForm,"code",t)},expression:"roleForm.code"}})],1),r("FormItem",{attrs:{label:"备注",prop:"description"}},[r("Input",{attrs:{autosize:{minRows:2,maxRows:5},placeholder:"备注"},model:{value:e.roleForm.description,callback:function(t){e.$set(e.roleForm,"description",t)},expression:"roleForm.description"}})],1),e.roleModal.edit?r("FormItem",{attrs:{label:"使用状态",prop:"state"}},[r("RadioGroup",{model:{value:e.roleForm.state,callback:function(t){e.$set(e.roleForm,"state",t)},expression:"roleForm.state"}},[r("Radio",{attrs:{label:"1"}},[e._v("启用")]),r("Radio",{attrs:{label:"0"}},[e._v("停用")])],1)],1):e._e()],1)],1),r("Modal",{attrs:{title:"菜单授权"},model:{value:e.setMenuModal,callback:function(t){e.setMenuModal=t},expression:"setMenuModal"}},[r("Tree",{ref:"menuTree",staticStyle:{margin:"50px"},attrs:{data:e.menuData,multiple:"","show-checkbox":""}}),r("div",{staticClass:"modal-footer",attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"success"},on:{click:e.saveMenu}},[e._v("保存")]),r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.checkAll("menuData")}}},[e._v("全选")]),r("Button",{attrs:{type:"info"},on:{click:function(t){return e.toggleCheck("menuData")}}},[e._v("反选")])],1)],1),r("Modal",{attrs:{title:"资源授权"},model:{value:e.setResourceModal,callback:function(t){e.setResourceModal=t},expression:"setResourceModal"}},[r("Tree",{ref:"resourceTree",staticStyle:{margin:"50px"},attrs:{data:e.resourceData,multiple:"","show-checkbox":""}}),r("div",{staticClass:"modal-footer",attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"success"},on:{click:e.saveResource}},[e._v("保存")]),r("Button",{attrs:{type:"primary"},on:{click:function(t){return e.checkAll("resourceData")}}},[e._v("全选")]),r("Button",{attrs:{type:"info"},on:{click:function(t){return e.toggleCheck("resourceData")}}},[e._v("反选")])],1)],1),r("Modal",{staticStyle:{"text-align":"center"},attrs:{title:"数据授权"},model:{value:e.setOrgModal,callback:function(t){e.setOrgModal=t},expression:"setOrgModal"}},[r("Tree",{ref:"orgTree",staticStyle:{margin:"50px"},attrs:{data:e.orgData,multiple:"","show-checkbox":""}}),r("div",{staticClass:"modal-footer",attrs:{slot:"footer"},slot:"footer"},[r("Button",{attrs:{type:"success"},on:{click:e.saveOrg}},[e._v("保存")]),r("Button",{attrs:{type:"info"},on:{click:function(t){return e.toggleCheck("menuData")}}},[e._v("反选")])],1)],1)],1)},a=[],s=(r("ac6a"),r("5176")),o=r.n(s),c=r("e814"),i=r.n(c),l=r("cebc"),u=(r("96cf"),r("3b8d")),d=r("e069"),p=r("4a80"),h=r("416d"),m=r("7c9b"),f={components:{Tree:h["a"],EasyTable:p["b"]},data:function(){var e=this;this.$createElement;return{table:Object(p["a"])({query:{name:null,code:null,state:null},loadData:function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(r){var n,a,s,o,c,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=r.PAGE_SIZE,a=r.current,s=r.query,t.next=3,e.$api.system.listRoles.send(Object(l["a"])({"page.pageSize":n,"page.pageNum":a},s));case 3:return o=t.sent,c=o.list,i=o.total,t.abrupt("return",{items:c,total:i});case 7:case"end":return t.stop()}},t)}));function r(e){return t.apply(this,arguments)}return r}(),COLUMNS:[{type:"index",maxWidth:100,align:"center",title:"序号"},{title:"角色名称",key:"name",align:"center"},{title:"角色代号",key:"code",align:"center"},{title:"使用状态",key:"stateValue",align:"center"},{title:"操作",key:"view",width:400,align:"center",render:function(t,r){var n=r.row,a={marginRight:"5px"};return t("div",[t(d["Button"],{attrs:{type:"primary",size:"small"},style:a,on:{click:function(){return e.showUpdateRoleModal(n)}}},["更改信息/状态"]),t(d["Button"],{attrs:{type:"success",size:"small"},style:a,on:{click:function(){return e.showMenuModal(n)}}},["菜单授权"]),t(d["Button"],{attrs:{type:"success",size:"small"},style:a,on:{click:function(){return e.showResourceModal(n)}}},["资源授权"]),t(d["Button"],{attrs:{type:"success",size:"small"},style:a,on:{click:function(){return e.showOrgModal(n)}}},["机构授权"]),0===i()(n.state)?t(d["Button"],{attrs:{type:"error",size:"small"},style:a,on:{click:function(){return e.deleteRole(n)}}},["删除"]):null])}}]}),roleModal:{show:!1,edit:!1,title:null},roleForm:{id:null,name:null,code:null,description:null,state:null},roleValidate:{name:[{required:!0,message:"角色名称不能为空",trigger:"blur"}],code:[{required:!0,message:"角色代号不能为空",trigger:"blur"}]},roleID:null,setMenuModal:!1,setResourceModal:!1,setOrgModal:!1,menuData:[],resourceData:[],orgData:[]}},created:function(){this.table.apply()},methods:{addRole:function(){o()(this.roleModal,{title:"新增角色",show:!0,edit:!1}),Object(m["a"])(this.roleForm,null)},save:function(){var e=this;this.$refs["roleForm"].validate(function(){var t=Object(u["a"])(regeneratorRuntime.mark(function t(r){var n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=11;break}return n=e.userModal.edit?"updateRole":"createRole",t.prev=2,t.next=5,e.$api.system[n].send(e.roleForm);case 5:e.$Message.success("提交成功!");case 6:return t.prev=6,e.table.refresh(),t.finish(6);case 9:t.next=12;break;case 11:e.$Message.error("表单验证失败!");case 12:case"end":return t.stop()}},t,null,[[2,,6,9]])}));return function(e){return t.apply(this,arguments)}}())},deleteRole:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$api.system.deleteRole.send({id:t.id});case 3:this.$Message.success("删除成功!");case 4:return e.prev=4,this.table.refresh(),e.finish(4);case 7:case"end":return e.stop()}},e,this,[[0,,4,7]])}));function t(t){return e.apply(this,arguments)}return t}(),showMenuModal:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.id,this.setMenuModal=!0,this.roleID=r,e.prev=3,e.next=6,this.$api.system.listRoleMenus.send({roleId:r});case 6:n=e.sent,n.length>0&&(this.menuData=n),e.next=12;break;case 10:e.prev=10,e.t0=e["catch"](3);case 12:case"end":return e.stop()}},e,this,[[3,10]])}));function t(t){return e.apply(this,arguments)}return t}(),toggleCheck:function(e){this[e].forEach(function(e){e.checked=!e.checked})},checkAll:function(e){this[e].forEach(function(e){e.checked=!0}),this.$Message.success("已全选！")},saveMenu:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$refs["menuTree"].getCheckedNodes().map(function(e){return e.id}),!(t.length>0)){e.next=11;break}return e.prev=2,e.next=5,this.$api.system.updateRoleMenus.send({roleId:this.roleID,menuIds:t.join(",")});case 5:this.$Message.success("提交成功"),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](2),this.$Message.error("提交失败!"+e.t0.message);case 11:this.setMenuModal=!1;case 12:case"end":return e.stop()}},e,this,[[2,8]])}));function t(){return e.apply(this,arguments)}return t}(),showUpdateRoleModal:function(e){Object(m["b"])(this.roleForm,e),o()(this.roleModal,{show:!0,edit:!0,title:"编辑角色"})},showResourceModal:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.id,this.setResourceModal=!0,this.roleID=r,e.prev=3,e.next=6,this.$api.system.listRoleResources.send({roleId:r});case 6:this.resourceData=e.sent,e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](3);case 11:case"end":return e.stop()}},e,this,[[3,9]])}));function t(t){return e.apply(this,arguments)}return t}(),saveResource:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$refs["resourceTree"].getCheckedNodes().map(function(e){return e.id}),!(t.length>0)){e.next=11;break}return e.prev=2,e.next=5,this.$api.system.updateRoleResources.send({roleId:this.roleID,resourceIds:t.join(",")});case 5:this.$Message.success("提交成功"),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](2),this.$Message.error("提交失败!"+e.t0.message);case 11:this.setResourceModal=!1;case 12:case"end":return e.stop()}},e,this,[[2,8]])}));function t(){return e.apply(this,arguments)}return t}(),showOrgModal:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=t.id,this.setOrgModal=!0,this.roleID=r,e.prev=3,e.next=6,this.$api.system.listRoleOrgs.send({roleId:r});case 6:this.orgData=e.sent,e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](3);case 11:case"end":return e.stop()}},e,this,[[3,9]])}));function t(t){return e.apply(this,arguments)}return t}(),saveOrg:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.$refs["orgTree"].getCheckedNodes().map(function(e){return e.id}),!(t.length>0)){e.next=11;break}return e.prev=2,e.next=5,this.$api.system.updateRoleOrgs.send({roleId:this.roleID,orgIds:t.join(",")});case 5:this.$Message.success("提交成功"),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](2),this.$Message.error("提交失败!"+e.t0.message);case 11:this.setOrgModal=!1;case 12:case"end":return e.stop()}},e,this,[[2,8]])}));function t(){return e.apply(this,arguments)}return t}()}},v=f,g=(r("60ce"),r("2877")),b=Object(g["a"])(v,n,a,!1,null,"1df00ec9",null);t["default"]=b.exports},b9e9:function(e,t,r){r("7445"),e.exports=r("584a").parseInt},e692:function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},e814:function(e,t,r){e.exports=r("b9e9")}}]);
//# sourceMappingURL=chunk-0d6a8843.6b8d49e6.js.map