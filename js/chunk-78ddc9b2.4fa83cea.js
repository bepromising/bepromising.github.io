(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-78ddc9b2"],{"416d":function(e,r,t){"use strict";r["a"]="./Tree.vue"},"517a":function(e,r,t){"use strict";t.r(r);var s=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("section",{staticClass:"subpage--main"},[t("Card",[t("div",{staticClass:"condition"},[t("label",{staticClass:"condition__item"},[e._v("\r\n        姓名：\r\n        "),t("Input",{staticClass:"input",attrs:{placeholder:"请输入姓名"},model:{value:e.table.unsyncQuery.name,callback:function(r){e.$set(e.table.unsyncQuery,"name",r)},expression:"table.unsyncQuery.name"}})],1),t("div",{staticClass:"condition__submit"},[t("Button",{attrs:{type:"info",shape:"circle",icon:"ios-search"},on:{click:e.table.apply}},[e._v("查询")]),t("Button",{attrs:{type:"primary",shape:"circle",icon:"person-add"},on:{click:e.addUser}},[e._v("新增")])],1)]),t("EasyTable",{staticStyle:{width:"100%"},attrs:{table:e.table,stripe:""}})],1),t("Modal",{attrs:{title:e.setUserModal.edit?"修改用户":"新增用户"},on:{"on-ok":e.setUser},model:{value:e.setUserModal.show,callback:function(r){e.$set(e.setUserModal,"show",r)},expression:"setUserModal.show"}},[t("Form",{ref:"userForm",attrs:{model:e.userForm,rules:e.ruleValidate,"label-width":120}},[e.setUserModal.edit?t("FormItem",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"ID",prop:"id"}},[t("Input",{model:{value:e.userForm.id,callback:function(r){e.$set(e.userForm,"id",r)},expression:"userForm.id"}})],1):e._e(),t("FormItem",{attrs:{label:"用户名",prop:"account"}},[t("Input",{attrs:{placeholder:"请输入用户名"},model:{value:e.userForm.account,callback:function(r){e.$set(e.userForm,"account",r)},expression:"userForm.account"}})],1),t("FormItem",{attrs:{label:"姓名",prop:"name"}},[t("Input",{attrs:{placeholder:"请输入姓名"},model:{value:e.userForm.name,callback:function(r){e.$set(e.userForm,"name",r)},expression:"userForm.name"}})],1),t("FormItem",{attrs:{label:"手机号码",prop:"phone"}},[t("Input",{attrs:{placeholder:"请输入手机号码"},model:{value:e.userForm.phone,callback:function(r){e.$set(e.userForm,"phone",r)},expression:"userForm.phone"}})],1),t("FormItem",{attrs:{label:"邮箱",prop:"mail"}},[t("Input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.userForm.mail,callback:function(r){e.$set(e.userForm,"mail",r)},expression:"userForm.mail"}})],1),e.setUserModal.edit?t("FormItem",{attrs:{label:"使用状态",prop:"status"}},[t("RadioGroup",{model:{value:e.userForm.state,callback:function(r){e.$set(e.userForm,"state",r)},expression:"userForm.state"}},[t("Radio",{attrs:{label:"1"}},[e._v("启用")]),t("Radio",{attrs:{label:"0"}},[e._v("停用")])],1)],1):e._e()],1)],1),t("Modal",{attrs:{title:"修改密码"},on:{"on-ok":e.modifyPassword},model:{value:e.modifyPasswordModal,callback:function(r){e.modifyPasswordModal=r},expression:"modifyPasswordModal"}},[t("Form",{ref:"modifyPasswordForm",attrs:{model:e.modifyPasswordForm,rules:e.modifyPasswordFormRule,"label-width":80}},[t("FormItem",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"ID",prop:"id"}},[t("Input",{model:{value:e.modifyPasswordForm.id,callback:function(r){e.$set(e.modifyPasswordForm,"id",r)},expression:"modifyPasswordForm.id"}})],1),t("FormItem",{attrs:{label:"密码",prop:"password"}},[t("Input",{attrs:{type:"password"},model:{value:e.modifyPasswordForm.password,callback:function(r){e.$set(e.modifyPasswordForm,"password",r)},expression:"modifyPasswordForm.password"}})],1),t("FormItem",{attrs:{label:"确认密码",prop:"rePassword"}},[t("Input",{attrs:{type:"password"},model:{value:e.modifyPasswordForm.rePassword,callback:function(r){e.$set(e.modifyPasswordForm,"rePassword",r)},expression:"modifyPasswordForm.rePassword"}})],1)],1)],1),t("Modal",{attrs:{title:"设置角色"},model:{value:e.setRoleModal,callback:function(r){e.setRoleModal=r},expression:"setRoleModal"}},[t("Tree",{ref:"roleTree",staticStyle:{margin:"50px"},attrs:{data:e.roleTreeData,multiple:"","show-checkbox":""}}),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"primary",size:"large",long:""},on:{click:e.setRole}},[e._v("确认")])],1)],1),t("Modal",{attrs:{title:"设置机构"},model:{value:e.setOrgModal,callback:function(r){e.setOrgModal=r},expression:"setOrgModal"}},[t("Tree",{ref:"orgTree",staticStyle:{margin:"50px"},attrs:{data:e.orgTreeData,"show-checkbox":""}}),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"primary",size:"large",long:""},on:{click:e.setOrg}},[e._v("确认")])],1)],1)],1)},a=[],n=t("5176"),o=t.n(n),i=t("e814"),l=t.n(i),u=t("cebc"),c=(t("96cf"),t("3b8d")),d=t("e069"),p=t("4a80"),m=t("416d"),f=t("7c9b"),h={components:{Tree:m["a"],EasyTable:p["b"]},data:function(){var e=this;this.$createElement;return{table:Object(p["a"])({query:{name:null},loadData:function(){var r=Object(c["a"])(regeneratorRuntime.mark(function r(t){var s,a,n,o,i,l;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:return s=t.PAGE_SIZE,a=t.current,n=t.query,r.next=3,e.$api.system.listUsers.send(Object(u["a"])({"page.pageSize":s,"page.pageNum":a},n));case 3:return o=r.sent,i=o.list,l=o.total,r.abrupt("return",{items:i,total:l});case 7:case"end":return r.stop()}},r)}));function t(e){return r.apply(this,arguments)}return t}(),COLUMNS:[{type:"index",maxWidth:100,align:"center",title:"序号"},{title:"用户名",key:"account",align:"center"},{title:"姓名",key:"name",align:"center"},{title:"邮箱",key:"email",align:"center"},{title:"电话",key:"phone",align:"center"},{title:"使用状态",key:"stateValue",align:"center"},{title:"操作",key:"view",width:400,align:"center",render:function(r,t){var s=t.row,a={marginRight:"5px"};return r("div",[r(d["Button"],{attrs:{type:"primary",size:"small"},style:a,on:{click:function(){return e.openUpdateUserModal(s)}}},["更改信息/状态"]),r(d["Button"],{attrs:{type:"success",size:"small"},style:a,on:{click:function(){return e.openSetRoleModal(s)}}},["设置角色"]),r(d["Button"],{attrs:{type:"success",size:"small"},style:a,on:{click:function(){return e.openSetOrgModal(s)}}},["设置机构"]),r(d["Button"],{attrs:{type:"warning",size:"small"},style:a,on:{click:function(){return e.openModifyPasswordModal(s)}}},["修改密码"]),0===l()(s.state)?r(d["Button"],{attrs:{type:"error",size:"small"},style:a,on:{click:function(){return e.deleteUser(s)}}},["删除"]):null])}}]}),setUserModal:{show:!1,edit:!1},userForm:{id:null,name:null,account:null,password:null,mail:null,phone:null,state:null},ruleValidate:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],account:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}],mail:[{type:"email",message:"邮箱格式不正确",trigger:"blur"}],phone:[{required:!0,message:"请输入正确的手机号码",len:11,trigger:"blur"}]},modifyPasswordModal:!1,modifyPasswordForm:{id:null,password:null,rePassword:null},modifyPasswordFormRule:{password:[{required:!0,message:"不能为空",trigger:"blur"}],rePassword:[{required:!0,message:"不能为空",trigger:"blur"}]},setRoleModal:!1,setOrgModal:!1,userId:null,roleTreeData:[],orgTreeData:[]}},created:function(){this.table.apply()},methods:{addUser:function(){Object(f["a"])(this.userForm,null),o()(this.setUserModal,{show:!0,edit:!1})},openUpdateUserModal:function(e){o()(this.setUserModal,{show:!0,edit:!0}),Object(f["b"])(this.userForm,e)},setUser:function(){var e=this;this.$refs.userForm.validate(function(){var r=Object(c["a"])(regeneratorRuntime.mark(function r(t){var s;return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:if(!t){r.next=11;break}return s=e.setUserModal.edit?"updateUser":"register",r.prev=2,r.next=5,e.$api.system[s].send(e.userForm);case 5:e.$Message.success("提交成功！");case 6:return r.prev=6,e.table.refresh(),r.finish(6);case 9:r.next=12;break;case 11:e.$Message.error("表单验证失败！");case 12:case"end":return r.stop()}},r,null,[[2,,6,9]])}));return function(e){return r.apply(this,arguments)}}())},openSetRoleModal:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(r){var t,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=r.id,this.userId=t,e.prev=2,e.next=5,this.$api.system.listUserRoles.send({userId:t});case 5:s=e.sent,s.length>0&&(this.roleTreeData=s,this.setRoleModal=!0),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),this.$Message.error("操作失败！"+e.t0.message);case 12:case"end":return e.stop()}},e,this,[[2,9]])}));function r(r){return e.apply(this,arguments)}return r}(),setRole:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(r=this.$refs["roleTree"].getCheckedNodes().map(function(e){return e.id}),e.prev=1,!(r.length>0)){e.next=7;break}return e.next=5,this.$api.system.createUserRole.send({userId:this.userId,roleIds:r.join(",")});case 5:e.next=9;break;case 7:return e.next=9,this.$api.system.deleteRelation.send({id:this.userId});case 9:this.$Message.success("提交成功"),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](1),this.$Message.error("提交失败！"+e.t0.message);case 15:this.setRoleModal=!1;case 16:case"end":return e.stop()}},e,this,[[1,12]])}));function r(){return e.apply(this,arguments)}return r}(),openSetOrgModal:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(r){var t,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=r.id,this.userId=t,e.prev=2,e.next=5,this.$api.system.listUserOrgs.send({userId:t});case 5:s=e.sent,s.length>0&&(this.orgTreeData=s,this.setOrgModal=!0),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](2),this.$Message.error("操作失败！"+e.t0.message);case 12:case"end":return e.stop()}},e,this,[[2,9]])}));function r(r){return e.apply(this,arguments)}return r}(),setOrg:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=this.$refs["orgTree"].getCheckedNodes().map(function(e){return e.id}),e.prev=1,e.next=4,this.$api.system.createUserOrg.send({userId:this.userId,orgId:r[0]});case 4:this.$Message.success("提交成功"),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.$Message.error("提交失败！"+e.t0.message);case 10:this.setOrgModal=!1;case 11:case"end":return e.stop()}},e,this,[[1,7]])}));function r(){return e.apply(this,arguments)}return r}(),openModifyPasswordModal:function(e){this.modifyPasswordModal=!0,o()(this.modifyPasswordForm,{id:e.id,password:null,rePassword:null})},modifyPassword:function(){var e=this;this.$refs.modifyPasswordForm.validate(function(){var r=Object(c["a"])(regeneratorRuntime.mark(function r(t){return regeneratorRuntime.wrap(function(r){while(1)switch(r.prev=r.next){case 0:if(!t){r.next=10;break}return r.prev=1,r.next=4,e.$api.system.resetPassword.send(e.modifyPasswordForm);case 4:e.$Message.success("提交成功！");case 5:return r.prev=5,e.table.refresh(),r.finish(5);case 8:r.next=11;break;case 10:e.$Message.error("表单验证失败！");case 11:case"end":return r.stop()}},r,null,[[1,,5,8]])}));return function(e){return r.apply(this,arguments)}}())},deleteUser:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(r){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=r.id,e.prev=1,e.next=4,this.$api.system.deleteUser.send({id:t});case 4:this.$Message.success("删除成功！");case 5:return e.prev=5,this.table.refresh(),e.finish(5);case 8:case"end":return e.stop()}},e,this,[[1,,5,8]])}));function r(r){return e.apply(this,arguments)}return r}()}},g=h,w=t("2877"),b=Object(w["a"])(g,s,a,!1,null,null,null);r["default"]=b.exports},"5d6b":function(e,r,t){var s=t("e53d").parseInt,a=t("a1ce").trim,n=t("e692"),o=/^[-+]?0[xX]/;e.exports=8!==s(n+"08")||22!==s(n+"0x16")?function(e,r){var t=a(String(e),3);return s(t,r>>>0||(o.test(t)?16:10))}:s},7445:function(e,r,t){var s=t("63b6"),a=t("5d6b");s(s.G+s.F*(parseInt!=a),{parseInt:a})},"7c9b":function(e,r,t){"use strict";function s(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var s in e)e.hasOwnProperty(s)&&-1===t.indexOf(s)&&(e[s]=r);return e}function a(e,r){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t in e)e.hasOwnProperty(t)&&(e[t]=r[t]);return e}t.d(r,"a",function(){return s}),t.d(r,"b",function(){return a})},a1ce:function(e,r,t){var s=t("63b6"),a=t("25eb"),n=t("294c"),o=t("e692"),i="["+o+"]",l="​",u=RegExp("^"+i+i+"*"),c=RegExp(i+i+"*$"),d=function(e,r,t){var a={},i=n(function(){return!!o[e]()||l[e]()!=l}),u=a[e]=i?r(p):o[e];t&&(a[t]=u),s(s.P+s.F*i,"String",a)},p=d.trim=function(e,r){return e=String(a(e)),1&r&&(e=e.replace(u,"")),2&r&&(e=e.replace(c,"")),e};e.exports=d},b9e9:function(e,r,t){t("7445"),e.exports=t("584a").parseInt},e692:function(e,r){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},e814:function(e,r,t){e.exports=t("b9e9")}}]);
//# sourceMappingURL=chunk-78ddc9b2.4fa83cea.js.map