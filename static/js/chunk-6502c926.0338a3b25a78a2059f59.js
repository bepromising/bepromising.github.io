(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6502c926"],{"2ab8":function(e,t,a){},"2f21":function(e,t,a){"use strict";var i=a("79e5");e.exports=function(e,t){return!!e&&i(function(){t?e.call(null,function(){},1):e.call(null)})}},"386d":function(e,t,a){a("214f")("search",1,function(e,t,a){return[function(a){"use strict";var i=e(this),s=void 0==a?void 0:a[t];return void 0!==s?s.call(a,i):new RegExp(a)[t](String(i))},a]})},4917:function(e,t,a){a("214f")("match",1,function(e,t,a){return[function(a){"use strict";var i=e(this),s=void 0==a?void 0:a[t];return void 0!==s?s.call(a,i):new RegExp(a)[t](String(i))},a]})},"55dd":function(e,t,a){"use strict";var i=a("5ca1"),s=a("d8e8"),n=a("4bf8"),r=a("79e5"),l=[].sort,c=[1,2,3];i(i.P+i.F*(r(function(){c.sort(void 0)})||!r(function(){c.sort(null)})||!a("2f21")(l)),"Array",{sort:function(e){return void 0===e?l.call(n(this)):l.call(n(this),s(e))}})},"6c2a":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mainWrap"},[e.loading?i("section",{staticClass:"loading"},[i("div",{staticClass:"mask"}),i("img",{attrs:{src:a("cf1c")}})]):e._e(),i("section",{staticClass:"leftTree"},[i("div",{staticClass:"searchTree",on:{keypress:function(t){return"button"in t||13===t.keyCode?e.searchTree(t):null}}},[i("Input",{staticStyle:{width:"160px"},attrs:{placeholder:"请输入指标",size:"small"},model:{value:e.treeKeyWord,callback:function(t){e.treeKeyWord=t},expression:"treeKeyWord"}}),i("Button",{attrs:{type:"primary",icon:"ios-search",size:"small",shape:"circle"},on:{click:e.searchTree}})],1),i("Tree",{attrs:{data:e.nodes,"show-checkbox":""},on:{"on-check-change":e.checkNode}})],1),i("section",{staticClass:"rightMain"},[i("section",{staticClass:"filter"},[i("Icon",{staticClass:"showFilter",attrs:{type:"funnel",size:"24"},nativeOn:{click:function(t){return e.showFilter(t)}}}),e._l(e.filter.conditions,function(t,a){return i("i",{key:a,staticClass:"filter-act"},[e._v(e._s(e.formatCondition(t))+"\n                    "),i("Icon",{staticClass:"edit",attrs:{type:"edit",size:"12"},nativeOn:{click:function(a){e.editFilter(t.field)}}}),i("Icon",{staticClass:"close",attrs:{type:"close-round",size:"12"},nativeOn:{click:function(a){e.removeFilter(t.field)}}})],1)}),i("div",{staticClass:"item"},[i("em",[e._v("实时查询")]),i("i-switch",{staticStyle:{float:"left",margin:"3px 0 0 4px"},on:{"~on-change":function(t){return e.infoRealTime(t)}},model:{value:e.search.realTime,callback:function(t){e.$set(e.search,"realTime",t)},expression:"search.realTime"}},[i("Icon",{attrs:{slot:"open",type:"android-done"},slot:"open"}),i("Icon",{attrs:{slot:"close",type:"android-close"},slot:"close"})],1)],1),i("div",{staticClass:"item"},[i("em",[e._v("可视化")]),i("i-switch",{staticStyle:{float:"left",margin:"3px 0 0 4px"},on:{"~on-change":function(t){return e.adjust(t)}},model:{value:e.isShowChart,callback:function(t){e.isShowChart=t},expression:"isShowChart"}},[i("Icon",{attrs:{slot:"open",type:"android-done"},slot:"open"}),i("Icon",{attrs:{slot:"close",type:"android-close"},slot:"close"})],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.search.realTime,expression:"!search.realTime"}],staticClass:"item"},[i("Button",{attrs:{type:"primary",icon:"ios-search",shape:"circle"},on:{click:function(t){e.searchNow(1)}}},[e._v("查询")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.search.realTime,expression:"!search.realTime"}],staticClass:"item"},[i("Button",{attrs:{type:"ghost",icon:"trash-b",shape:"circle"},on:{click:e.forceUpdate}},[e._v("重置")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.table.data.length>0,expression:"table.data.length > 0"}],staticClass:"item"},[i("Button",{attrs:{type:"primary",icon:"document",shape:"circle"},on:{click:e.exportNow}},[e._v("导出")])],1)],2),e.filter.isShowFilter?[i("div",{staticClass:"filterMask",on:{click:e.closeFilter}}),i("section",{staticClass:"filterWrap",on:{keyup:function(t){return"button"in t||13===t.keyCode?e.saveFilter(t):null}}},[i("i",{staticClass:"arrow"}),i("h1",[e._v("选择过滤字段")]),i("div",{staticClass:"itemWrap"},[i("em",[e._v("字段")]),i("Select",{staticClass:"filterItem",staticStyle:{width:"160px"},attrs:{clearable:"",filterable:""},on:{"on-change":e.changeFilter},model:{value:e.filter.field,callback:function(t){e.$set(e.filter,"field",t)},expression:"filter.field"}},e._l(e.search.checkedNodes,function(t){return i("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],1),e.filter.field?i("section",{staticClass:"filterContent"},[i("div",{staticClass:"menu"},e._l(e.filter.filterTags,function(t,a){return i("i",{key:a,class:{act:t.act}},[e._v(e._s(t.name))])})),i("div",{staticClass:"settingWrap"},["value"===e.filter.openFilter?[i("div",{staticClass:"item"},[i("em",[e._v("操作符")]),i("Select",{staticStyle:{width:"120px"},attrs:{clearable:""},model:{value:e.filter.selectOper,callback:function(t){e.$set(e.filter,"selectOper",t)},expression:"filter.selectOper"}},e._l(e.filter.filters.value,function(t){return i("Option",{key:t.value,attrs:{value:t.value}},[e._v("\n                                        "+e._s(t.name)+"\n                                    ")])}))],1),i("div",{staticClass:"item"},[i("em",[e._v("数值")]),i("Input",{staticClass:"fill",model:{value:e.filter.minValue,callback:function(t){e.$set(e.filter,"minValue",t)},expression:"filter.minValue"}}),"between"===e.filter.selectOper?[i("em",{staticClass:"toText"},[e._v("-")]),i("Input",{staticClass:"fill",model:{value:e.filter.maxValue,callback:function(t){e.$set(e.filter,"maxValue",t)},expression:"filter.maxValue"}})]:e._e()],2)]:e._e(),"text"===e.filter.openFilter?[i("div",{staticClass:"item"},[i("em",[e._v("操作符")]),i("Select",{staticStyle:{width:"120px"},attrs:{clearable:""},model:{value:e.filter.selectOper,callback:function(t){e.$set(e.filter,"selectOper",t)},expression:"filter.selectOper"}},e._l(e.filter.filters.text,function(t){return i("Option",{key:t.value,attrs:{value:t.value}},[e._v("\n                                        "+e._s(t.name)+"\n                                    ")])}))],1),i("div",{staticClass:"item"},[i("em",[e._v("文本")]),i("Input",{staticClass:"fill",staticStyle:{width:"120px"},model:{value:e.filter.minValue,callback:function(t){e.$set(e.filter,"minValue",t)},expression:"filter.minValue"}})],1)]:e._e(),i("div",{staticClass:"item"},[i("em",[e._v(" ")]),i("Button",{attrs:{type:"primary"},on:{click:e.saveFilter}},[e._v("提交")])],1)],2)]):e._e()])]:e._e(),i("section",{staticClass:"resultWrap"},[i("transition",{attrs:{name:"fade"}},[e.isShowChart?i("section",{staticClass:"chartWrap"},[i("custom-echarts",{attrs:{fields:e.search.checkedNodes,echartData:e.chartData},on:{"on-need-search":e.loadEchartsData}})],1):e._e()]),e.table.data.length>0?i("section",{ref:"tableWrap",staticClass:"tableWrap"},[i("Table",{attrs:{columns:e.table.columns,data:e.table.data,size:"small",stripe:""},on:{"on-sort-change":e.sortTable}}),i("Page",{staticClass:"page",attrs:{total:e.table.page.total,"page-size":e.table.page.pageSize,"show-elevator":""},on:{"on-change":e.changePage}})],1):e._e()],1)],2)])},s=[],n=(a("20d6"),a("7f7f"),a("6762"),a("2fdb"),a("28a5"),a("7514"),a("f751"),a("a481"),a("386d"),a("c93e")),r=(a("ac6a"),a("0db3")),l=a("f121"),c=a("ed08"),o=a("bedf"),h=(a("55dd"),a("a322"));function u(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}function f(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function p(e){return u(e)||f(e)||d()}a("6b54"),a("6bde");var g={symbol:"path://M1233.329493 174.421333h-1112.064c-34.128213 0-61.781333 27.661653-61.781333 61.781334v473.658026c0 34.117973 27.65312 61.781333 61.781333 61.781334h472.80128l83.23072 144.155306 83.23072-144.155306h472.80128c34.128213 0 61.781333-27.66336 61.781334-61.781334V236.202667c0-34.117973-27.65312-61.781333-61.781334-61.781334z",symbolOffset:[0,"-50%"],label:{normal:{verticalAlign:"bottom",lineHeight:22}}},m=function(e,t,a){var i=a.stack,s=a.subType,r={max:{belong:"markPoint",data:Object(n["a"])({type:"max",name:"最大值"},g)},min:{belong:"markPoint",data:Object(n["a"])({type:"min",name:"最小值"},g)},average:{belong:"markLine",data:{type:"average",name:"平均值",label:{normal:{show:!0,position:"middle"}}}}},l={},c=i?14:9;return e.forEach(function(e){var t=r[e];l[t.belong]||(l[t.belong]={data:[]}),l[t.belong].data.push(t.data)}),t.map(function(e){var t=Math.max.apply(Math,p(e.data)).toString().length;return l.markPoint&&l.markPoint.data.forEach(function(e){e.symbolSize=[t*c,40],["Hbar","SHbar"].indexOf(s)>-1?(e.symbolRotate=-90,e.symbolOffset=["25%",0],e.label.normal.rotate=-90,e.itemStyle={normal:{borderColor:"#fff",borderWidth:2}}):(e.label.normal.rotate=0,e.itemStyle={})}),Object.assign(e,l),e})},v={area:["area"],xyReverse:["Hbar","SHbar"],rose:["rose"],circular:["circular"]},b=function(e,t,a){a.type,a.stack;var i=function(e,t,i){var s=i.axisX,n=i.axisY,r=i.type,l=i.stack,c=i.subType,o=i.markers,u=i.adjust,f={},d=[],p=[];e.forEach(function(e,a){var i=e[s];d.push(i),-1===d.indexOf(i)&&d.push(i),n.forEach(function(a){var i=t.find(function(e){return e.id===a.replace("col_","")});i&&(f[i.name]||(f[i.name]=Object(h["a"])({},e[l],{})),f[i.name][e[l]]?f[i.name][e[l]][e[s]]?f[i.name][e[l]][e[s]]+=e[a]:f[i.name][e[l]][e[s]]=e[a]:f[i.name][e[l]]=Object(h["a"])({},e[s],e[a]))})});var g=function(e){var t=function(t){var a={name:t,stack:e,type:r,data:d.map(function(a){return f[e][t][a]||0})};u.labelPosition&&(a.label={show:!0,position:u.labelPosition}),p.push(a)};for(var a in f[e])t(a)};for(var b in f)g(b);var y={title:"",series:o.length>0?m(o,p,a):p};return v.xyReverse.indexOf(c)>-1?Object.assign(y,{xAxis:{type:"value"},yAxis:{type:"category",data:d}}):y.axisX=d,y},s=function(e,t,i){var s=i.axisX,n=i.axisY,r=i.type,l=i.subType,c=i.markers,o=i.adjust,h=[],u=[];e.forEach(function(e,a){var i=e[s];h.push(i),n.forEach(function(i){if(0===a){var s=t.find(function(e){return e.id===i.replace("col_","")}),n={name:s.name,id:i,data:[],type:r};o.labelPosition&&(n.label={show:!0,position:o.labelPosition}),u.push(n)}var l=u.find(function(e){return e.id===i});l.data.push(e[i])})});var f={title:"",series:c.length>0?m(c,u,a):u};return v.area.indexOf(l)>-1&&u.map(function(e){return e.areaStyle={normal:{}},e}),v.xyReverse.indexOf(l)>-1?Object.assign(f,{xAxis:{type:"value"},yAxis:{type:"category",data:h}}):(f.axisX=h,o.rotate&&(f.xAxis={axisLabel:{rotate:o.rotate}})),f},n=function(e,t,a){var i=a.axisX,s=a.axisY,n=a.type,r=a.subType,l=[],c=[];return e.forEach(function(e,a){var o=e[i];l.push(o),s.forEach(function(i){if(0===a){var s=t.find(function(e){return e.id===i.replace("col_","")});c.push({name:s.name,id:i,data:[],type:n,label:{formatter:"{b}：共{c}，占{d}%"}})}var l=c.find(function(e){return e.id===i});l.data.push({name:o,value:e[i]}),v.circular.indexOf(r)>-1&&(l.radius=["30%","70%"]),v.rose.indexOf(r)>-1&&(l.roseType="radius")})}),{legend:{data:l},type:"pie",title:"",series:c}},r=function(e){var t={bar:s,line:s,pie:n,Sbar:e.stack?i:s,Hbar:s,SHbar:e.stack?i:s,area:s,circular:n,rose:n};return t[e.subType]};return r(a)(e,t,a)},y=function(e){var t=e.fields,a=e.page,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=t.filter(function(e){return null!==e.refField}).map(function(e){return e.refField}),r=t.filter(function(e){return-1===n.indexOf(e.fieldName)}).map(function(e){var t={title:e.fieldCnName,key:e.fieldName,fieldAttr:parseInt(e.fieldAttr)};return s&&i[e[s]]&&Object.assign(t,i[e[s]]),t.hasOwnProperty("align")||(t.align="center",t.sortable="custom"),t});return r.sort(function(e,t){return e.fieldAttr>t.fieldAttr?1:e.fieldAttr<t.fieldAttr?-1:0}),{columns:r,data:a.list,page:{pageSize:a.pageSize,total:a.total,pages:a.pages}}},C=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"echartsWrap"},[a("Icon",{staticClass:"hideBtn",attrs:{type:e.echartsConfig.maxEchart?"gear-b":"close-circled"},nativeOn:{click:function(t){return e.toggleConfig(t)}}}),a("transition",{attrs:{name:"fade-left"},on:{"after-leave":e.finishTransition,"after-enter":e.finishTransition}},[e.echartsConfig.maxEchart?e._e():a("div",{staticClass:"echartsConfig"},[a("div",{staticClass:"typeList"},e._l(e.echartsConfig.typeIcoList,function(t){return a("Tooltip",{key:t.subType,staticClass:"ico",class:{"ico-checked":t.checked},attrs:{content:t.name,delay:1e3},nativeOn:{click:function(a){e.checkChartType(t.type,t.subType)}}},[a("img",{key:t.subType,attrs:{src:"static/svg/"+t.icon}})])})),a("div",{staticClass:"itemLi"},[a("em",[e._v("维度")]),a("Select",{staticClass:"fill",attrs:{clearable:""},on:{"on-change":e.changeXAxis},model:{value:e.echartsConfig.axisX,callback:function(t){e.$set(e.echartsConfig,"axisX",t)},expression:"echartsConfig.axisX"}},e._l(e.echartsConfig.axisXList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.name))])})),a("Icon",{staticClass:"icon",attrs:{type:"ios-settings-strong"}})],1),a("div",{staticClass:"itemLi"},[a("em",[e._v("量度")]),a("Select",{staticClass:"fill",attrs:{multiple:"",clearable:""},on:{"on-change":e.changeYAxis},model:{value:e.echartsConfig.axisY,callback:function(t){e.$set(e.echartsConfig,"axisY",t)},expression:"echartsConfig.axisY"}},e._l(e.echartsConfig.axisYList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.name))])}))],1),a("transition",{attrs:{name:"fade"}},[e.echartsConfig.needStack.includes(e.echartsConfig.subType)?a("div",{staticClass:"itemLi"},[a("em",[e._v("分组")]),a("Select",{staticClass:"fill",attrs:{clearable:""},on:{"on-change":e.loadChart},model:{value:e.echartsConfig.stack,callback:function(t){e.$set(e.echartsConfig,"stack",t)},expression:"echartsConfig.stack"}},e._l(e.echartsConfig.stackList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v("\n                            "+e._s(t.name)+"\n                        ")])}))],1):e._e()]),a("transition",{attrs:{name:"fade"}},[e.echartsConfig.needMarkers.includes(e.echartsConfig.subType)?a("div",{staticClass:"itemLi",staticStyle:{height:"auto"}},[a("em",[e._v("标记")]),a("CheckboxGroup",{staticClass:"fill",on:{"on-change":e.changeMarkers},model:{value:e.echartsConfig.markers,callback:function(t){e.$set(e.echartsConfig,"markers",t)},expression:"echartsConfig.markers"}},[a("Checkbox",{attrs:{label:"max"}},[e._v("最大值")]),a("Checkbox",{attrs:{label:"min"}},[e._v("最小值")]),a("Checkbox",{attrs:{label:"average"}},[e._v("平均值")])],1)],1):e._e()])],1)]),a("div",{staticClass:"echartsResult",class:{fullfill:e.echartsConfig.maxEchart}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"}],staticClass:"empty"},[e._v("请先进行配置")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"chart",attrs:{id:"chart"}})])],1)},x=[],k=a("c665"),w=a("aa9a"),O=a("7c9b"),_=a("313e"),S=a.n(_),T={},E=null,F=["#7cb5ec","#FF7F50","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#8085e8","#8d4653","#91e8e1","#C1232B","#B5C334","#FCCE10","#E87C25","#27727B","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B","#C6E579","#F4E001","#F0805A","#26C0C0"],j=function(){function e(t){Object(k["a"])(this,e),this.globalConfigs=t||{},this.echartsConfig=null,this.charts={},this.typeDefaults={pie:{tipFormatter:"{a} <br/>{b} : {c} ({d}%)",trigger:"item"}},this.defaults={subTitle:"",titleX:"center",showTip:!0,pointByColors:!0,grid:{left:"5%",right:"5%"},color:["#7cb5ec","#FF7F50","#90ed7d","#f7a35c","#8085e9","#f15c80","#e4d354","#8085e8","#8d4653","#91e8e1","#C1232B","#B5C334","#FCCE10","#E87C25","#27727B","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B","#C6E579","#F4E001","#F0805A","#26C0C0"],showLegend:!0,legendType:"scroll",legendY:"bottom",legendX:"center",cursor:"cross",seriesVisable:null,axisLabelInterval:0,boundaryGap:!1,axisY:function(e,t){return!(["pie"].indexOf(e.type)>-1||e.yAxis)&&(e.axisY?Array.isArray(e.axisY)?e.axisY.map(function(e,t){var a={type:"value"};return"name"in e&&(a["name"]=e["name"]),"unit"in e&&!("axisLabel"in e)&&(a["axisLabel"]={formatter:"{value}"+e["unit"]}),a}):void 0:(t.echartsConfig["yAxis"]={type:"value"},!1))},legends:function(e,t){var a=[];if(t.defaults["showLegend"]){var i=e.transforms?"transforms":"series";return e[i]&&Array.isArray(e[i])&&(a=e[i].map(function(e){return e["name"]})),a}},axisX:function(e,t){return!(["pie"].indexOf(e.type)>-1)&&(e["axisX"]?e["axisX"]:null)},trigger:function(e,t){return["pie"].indexOf(e.type)>-1?t.echartsConfig["tooltip"]?t.echartsConfig["tooltip"]["trigger"]?{trigger:"item"}:void 0:{formatter:"{a} <br/>{b} : {c} ({d}%)"}:"axis"}},this.defaultsMap={title:"title.text",titleX:"title.x",color:"color",showTip:"tooltip.show",trigger:"tooltip.trigger",showLegend:"legend.show",seriesVisable:"legend.selected",legendX:"legend.x",legendY:"legend.y",legendType:"legend.type",legends:"legend.data",grid:"grid",axisX:"xAxis.data",axisY:"yAxis",cursor:"tooltip.axisPointer.type",tipFormatter:"tooltip.formatter",transforms:"series",axisLabelInterval:"xAxis.axisLabel.interval"},this.specialMap=function(e){return{title:function(t,a){if(a[t]instanceof Object)return e.echartsConfig[t]=a[t],!0},tipFormatter:function(t,a){if(a[t])return e.echartsConfig["tooltip"]={formatter:a[t]},!0},transforms:function(t,a,i){var s={bar:function(t,a){e.echartsConfig["series"]=a[t].map(function(e){return e.type="bar",e})},line:function(t,a){e.echartsConfig["series"]=a[t].map(function(e){return e.type="line",e})},pie:function(t,a){var i,s=a[t].length>1;if(s){var r=JSON.parse(JSON.stringify(e.echartsConfig)),l=[];a[t].forEach(function(e,t){e.data.forEach(function(a,i){0===t&&l.push({series:[{type:"pie",data:[]}]}),l[i].series[0].data[t]={name:e.name,value:a}})}),r.legend&&!0===r.legend.show&&Object.assign(r.legend,{x:"right",y:"top"}),e.echartsConfig={baseOption:Object(n["a"])({},r,{series:[{type:"pie"}],timeline:{axisType:"category",data:a.axisX}}),options:l}}else e.echartsConfig["series"]=a[t].map(function(e){return i=e.data.map(function(e,t){return{name:a.axisX[t],value:e}}),Object(n["a"])({},e,{type:"pie",data:i})})}},r=a.type;return s[r](t,a),!0}}}(this)}return Object(w["a"])(e,[{key:"load",value:function(e){if(this.globalConfigs)for(var t in this.globalConfigs)this.defaults[t]=this.globalConfigs[t];for(var a in e){var i=e[a].type||null;this.charts[a]&&this.charts[a].clear(),this.createEcharts(a,e[a],i)}return this}},{key:"clear",value:function(){for(var e in this.charts)this.charts[e].clear();return this}},{key:"resize",value:function(){for(var e in this.charts)this.charts[e].resize();return this}},{key:"update",value:function(e){for(var t in this.echartsConfig=null,e){var a=this.parseConfig(e[t],"update");this.charts[t].setOption(a)}return this}},{key:"parseConfig",value:function(e,t){if(this.globalConfigs&&this.globalConfigs.isEchartsConfig)return e;var a=this;for(var i in this.echartsConfig=function(){var t=Object(O["a"])(e),i={};for(var s in t)"type"===s||s in a.defaultsMap||s in a.specialMap||(i[s]=t[s]);return t=null,i}(),this.defaults)i in this.defaultsMap||!e.hasOwnProperty(i)&&!this.globalConfigs.hasOwnProperty(i)||(this.echartsConfig[i]=this.defaults[i]);for(var s in this.defaultsMap)if(("update"!==t||s in e)&&!(s in e&&s in this.specialMap&&this.specialMap[s](s,e,t))){var n=this.defaultsMap[s].split("."),r=void 0;if("function"===typeof this.defaults[s]){var l=this.defaults[s](e,this);if(!1===l)continue;r=l}else{var c=this.typeDefaults[e.type]&&this.typeDefaults[e.type][s]?this.typeDefaults[e.type][s]:this.defaults[s];r=s in e?e[s]:c}switch(n.length){case 1:this.echartsConfig[n[0]]||(this.echartsConfig[n[0]]=r);break;case 2:this.echartsConfig[n[0]]&&!this.echartsConfig[n[0]][n[1]]?this.echartsConfig[n[0]][n[1]]=r:this.echartsConfig[n[0]]||(this.echartsConfig[n[0]]={},this.echartsConfig[n[0]][n[1]]=r);break;case 3:this.echartsConfig[n[0]]||(this.echartsConfig[n[0]]={}),this.echartsConfig[n[0]]&&!this.echartsConfig[n[0]][n[1]]&&(this.echartsConfig[n[0]][n[1]]={}),this.echartsConfig[n[0]][n[1]][n[3]]||(this.echartsConfig[n[0]][n[1]][n[2]]=r);break}}return e.pointByColors&&this.echartsConfig.series.forEach(function(e){/^\d+$/.test(e.data.join(""))&&(e.data=e.data.map(function(e,t){return{value:e,itemStyle:{normal:{color:F[t%F.length]}}}}))}),this.echartsConfig}},{key:"createEcharts",value:function(e,t,a){var i=this.charts[e]||S.a.init(document.getElementById(e)),s=this.parseConfig(t);["pie","tree","funnel","sunburst"].indexOf(a)>-1&&(delete s.xAxis,delete s.yAxis),i.setOption(s),this.charts[e]=i}},{key:"getInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?this.charts[e]:this.charts}}],[{key:"loadOriginal",value:function(e){for(var t in E=S.a,T={},e){var a=S.a.getInstanceByDom(document.getElementById(t))||S.a.init(document.getElementById(t));T[t]=a,a.clear(),e[t].color||(e[t].color=F),a.setOption(e[t])}}},{key:"getCharts",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?T[e]:T}},{key:"getEcharts",value:function(){return E}},{key:"getColors",value:function(){return F}}]),e}(),A={data:function(){return{$chart:null,echartsConfig:{typeList:{bar:"柱状图",line:"折线图",pie:"饼图"},needStack:["Sbar","SHbar"],needMarkers:["bar","Hbar","Sbar","SHbar","line","area"],markers:[],typeIcoList:[{name:"柱状图",type:"bar",icon:"bar.svg",subType:"bar",checked:!0},{name:"横向柱状图",type:"bar",icon:"Hbar.svg",subType:"Hbar",checked:!1},{name:"堆叠柱状图",type:"bar",icon:"Sbar.svg",subType:"Sbar",checked:!1},{name:"横向堆叠柱状图",type:"bar",icon:"SHbar.svg",subType:"SHbar",checked:!1},{name:"折线图",type:"line",icon:"line.svg",subType:"line",checked:!1},{name:"面积图",type:"line",icon:"area.svg",subType:"area",checked:!1},{name:"饼图",type:"pie",icon:"pie.svg",subType:"pie",checked:!1},{name:"环形图",type:"pie",icon:"circular.svg",subType:"circular",checked:!1},{name:"南丁格尔图",type:"pie",icon:"rose.svg",subType:"rose",checked:!1}],maxEchart:!1,subType:"bar",type:"bar",axisY:[],axisYList:[],axisX:null,axisXList:[],stack:null,stackList:[],sum:[],sumList:[]},isShow:!1}},props:{fields:{type:Array,default:function(){return[]}},echartData:{type:Array,default:function(){return[]}}},watch:{fields:function(){this.updateConfig(),this.reset()},echartData:function(){this.loadChart()}},methods:{reset:function(){this.$chart.clear(),Object.assign(this.echartsConfig,{axisX:null,axisY:[],stack:null,sum:[]})},finishTransition:function(){var e=this;window.setTimeout(function(){e.$chart.resize()},200)},checkChartType:function(e,t){var a=this.echartsConfig.typeIcoList.find(function(e){return e.subType===t});if(a){var i=this.echartsConfig.typeIcoList.find(function(e){return!0===e.checked});i&&(i.checked=!1),a.checked=!0,this.echartsConfig.type=e,this.echartsConfig.subType=t,this.loadChart()}},changeMarkers:function(e){this.loadChart()},toggleConfig:function(){this.echartsConfig.maxEchart=!this.echartsConfig.maxEchart},updateConfig:function(){if(!this.fields||0===this.fields.length)return!1;var e=[],t=[],a=[],i=[];this.fields.forEach(function(s){var n=parseInt(s.attr,10),r={value:-1===s.id.indexOf("col_")?"col_"+s.id:s.id,name:s.name};switch(n){case 0:e.push(r),a.push(r);break;case 1:t.push(r),i.push(r);break}}),Object.assign(this.echartsConfig,{axisXList:e,axisYList:t,stackList:a,sumList:i})},changeYAxis:function(e){var t=!1;"pie"===this.echartsConfig.type&&e.length>1&&(t=!0,this.echartsConfig.axisY=[e[1]]),t||this.loadChart(!0)},changeXAxis:function(e){this.loadChart(!0)},loadChart:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.echartsConfig,a=t.axisX,i=t.axisY,s=t.type;if(a&&0!==i.length){if(!s)return this.$Message.info("请先选择图形类型！"),!1;if(e||!this.echartData||0===this.echartData.length){var n=i.find(function(e){return e.indexOf("c80fbdf0a4eb11e7988555a026dee4dc")>-1})?[]:[a].concat(p(i));return this.$emit("on-need-search",n),!1}this.isShow=!0;var r=b(this.echartData,this.fields,this.echartsConfig);r.series.length>0&&(Object.assign(r,{toolbox:{show:!0,feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},saveAsImage:{}}}}),this.echartData.length>1e3?this.$Modal.error({title:"系统提示",content:"当前查询到".concat(this.echartData.length,"条数据，进行可视化会导致系统缓慢或崩溃!")}):this.$nextTick(function(){this.$chart.load({chart:r})}))}else this.$chart.clear(),this.isShow=!1}},created:function(){this.$chart=new j({backgroundColor:"#fff",trigger:"axis",grid:{top:40,bottom:60,left:"12%",right:"2%"}}),this.updateConfig()}},I=A,N=(a("9b66"),a("2877")),$=Object(N["a"])(I,C,x,!1,null,"7d47a6c4",null);$.options.__file="CustomEcharts.vue";var V=$.exports,L=l["b"].API,M=l["b"].nodeConfig,B=l["b"].filterCondition,D={data:function(){return{table:{columns:[],data:[]},isShowChart:!1,loading:!1,chartData:[],filter:{field:null,isShowFilter:!1,filters:"",filterTags:[],selectOper:"",minValue:"",maxValue:"",conditions:[],openFilter:null,orderBy:[]},treeKeyWord:null,nodes:[],search:{checkedNodes:[],lock:!0,realTime:!1,allCondition:null,errorMessage:null},page:{pageSize:15,pageNum:1}}},components:{Tree:r["a"],CustomEcharts:V},computed:{searchParams:function(){var e=[];return this.filter.conditions.forEach(function(t){"between"===t.selectOper?e.push({attr:t.attr,col:t.field,value:t.minValue,oper:"ge"},{attr:t.attr,col:t.field,value:t.maxValue,oper:"le"}):e.push({attr:t.attr,col:t.field,value:t.minValue,oper:t.selectOper})}),Object(n["a"])({fields:this.search.checkedNodes.map(function(e){return e.id}).join(",")},e.toUrlParmas("conditions"),this.filter.orderBy.toUrlParmas("orders"))}},methods:{forceUpdate:function(){location.reload()},adjust:function(){this.table.columns=this.table.columns.map(function(e){return e})},infoRealTime:function(){var e=this;this.$Modal.info({title:"温馨提示",content:"在数据量较大的情况下实时查询频繁查询会影响查询效率"}),window.setTimeout(function(){e.$Modal.remove()},5e3)},sortTable:function(e){e.column;var t=e.key,a=e.order;this.filter.orderBy=[{col:t.replace("col_",""),order:a}],this.searchNow(2)},loadEchartsData:function(e){var t=this;this.loading=!0;var a=Object(n["a"])({},this.searchParams);e&&e.length>0&&(a["subQuery.fields"]=e.join(",").replace(/col_/g,"")),this.$http({url:L.searchAll,method:"post",data:a}).then(function(e){var a=e.data;if(t.loading=!1,!0===a.success){var i=a.result;t.chartData=i.data}})},checkNode:function(e){var t=[],a=!1,i=!1,s=[];e.forEach(function(e){e.children&&0!==e.children.length||(t.push(e),0===parseInt(e.attr)&&(i=!0),1===parseInt(e.attr)&&(a=!0),-1===s.indexOf(e.subjectId)&&null!==e.subjectId&&s.push(e.subjectId))}),this.search.checkedNodes=t,a&&i?s.length>1?Object.assign(this.search,{lock:!0,errorMessage:"所选的字段不能进行联表查询！"}):this.search.lock=!1:Object.assign(this.search,{lock:!0,errorMessage:"必须同时选择维度和量度才能进行查询！"}),this.searchNow()},showFilter:function(){this.search.checkedNodes.length>0?this.filter.isShowFilter=!0:this.$Message.warning("您没有选择任何查询字段，请先在左侧的树中勾选字段！")},closeFilter:function(){this.filter.isShowFilter=!1,this.resetFilter()},changeFilter:function(e){var t=this,a=this.search.checkedNodes.find(function(t){return t.id===e}),i=this.filter.conditions.find(function(e){return e.field===t.filter.field}),s=!1,r=!1;if(a){this.filter.filterTags=[];var l=a.conditionOper.split(","),c=[],o={};l.includes("gt")&&(c.push({type:"value",name:B.value.name}),o.value=B.value.list,s=!0),l.includes("like")&&(c.push({type:"text",name:B.text.name}),o.text=B.text.list,r=!0),c.length>0&&!c.some(function(e){return!0===e.act})&&(c[0].act=!0),r&&s||s?this.filter.openFilter="value":r&&(this.filter.openFilter="text"),Object.assign(this.filter,{filters:o,filterTags:c})}i?(this.filter.selectOper=null,Object.assign(this.filter,i)):this.filter=Object(n["a"])({},this.filter,{selectOper:null,minValue:null,maxValue:null})},resetFilter:function(){this.filter=Object(n["a"])({},this.filter,{selectOper:null,minValue:null,maxValue:null,field:null})},saveFilter:function(){var e=this,t=this.filter.conditions.findIndex(function(t){return t.field===e.filter.field}),a=null;if(this.filter.selectOper?"between"!==this.filter.selectOper||this.filter.minValue||this.filter.minValue?this.filter.minValue||(a="数值不能为空！"):a="选择区间必须填写最大最小值！":a="操作符必选！",null!==a)return this.$Modal.error({title:"系统提示",content:a}),!1;var i=this.search.checkedNodes.find(function(t){return t.id===e.filter.field}),s={field:this.filter.field,name:i.name,selectOper:this.filter.selectOper,minValue:this.filter.minValue,maxValue:this.filter.maxValue,template:B.template[this.filter.selectOper],attr:i.attr};-1===t?this.filter.conditions.push(s):this.filter.conditions[t]=s,this.closeFilter(),this.searchNow(1)},formatCondition:function(e){var t=e.template,a=e.name,i=e.minValue,s=e.maxValue;return Object(o["b"])(t,{name:a,minValue:i,maxValue:s})},removeFilter:function(e){this.filter.conditions=this.filter.conditions.filter(function(t){return t.field!==e}),this.searchNow(1)},editFilter:function(e){var t=this.filter.conditions.find(function(t){return t.field===e});Object.assign(this.filter,t),this.filter.isShowFilter=!0},searchNow:function(e){var t=this;if(!1===this.search.realTime&&!e)return!1;if(0===this.search.checkedNodes.length)return this.$Message.warning("您没有选择任何查询字段，请先在左侧的树中勾选字段！"),!1;if(this.search.lock)return this.$Modal.error({title:"系统提示",content:this.search.errorMessage}),!1;var a=JSON.stringify(this.searchParams),i=this.search.allCondition;if(2===e||a!==i){var s=this.$http;this.loading=!0,s({url:L.search,method:"post",data:Object(n["a"])({},this.searchParams,{"page.pageSize":this.page.pageSize,"page.pageNum":this.page.pageNum})}).then(function(e){var a=e.data,i=a.result;t.loading=!1,!0===a.success&&(t.search.allCondition=JSON.stringify(t.searchParams),Object.assign(t.table,y(i)))}),this.isShowChart&&this.loadEchartsData()}},changePage:function(e){this.page.pageNum=e,this.searchNow(2)},exportNow:function(){Object(c["c"])(L.exportNow,{data:this.searchParams})},searchTree:function(){var e=this;if(this.treeKeyWord.length>=1){var t=[];if(this.nodes.forEach(function(a){a.selected=!1,a.expand=!1,a.name.indexOf(e.treeKeyWord)>-1&&(t.push(a),a.selected=!0)}),0===t.length)return this.$Modal.info({title:"系统提示",closable:!0,content:"未找到关键字为“".concat(this.treeKeyWord,"”的字段。")}),!1;t.forEach(function(t){var a=t.parentId;while("0"!=a){var i=e.nodes.find(function(e){return e.id===a});i&&(i.expand=!0),a=i.parentId}}),this.nodes=this.nodes.map(function(e){return e})}}},created:function(){var e=this;this.$http({url:L.getTreeNodes,method:"post"}).then(function(t){var a=t.data;if(!0===a.success){var i=[];a.result.forEach(function(e){M[e.attr]&&(e.icon=M[e.attr].icon),i.push(e)}),e.nodes=i}})}},X=D,P=(a("9c18"),Object(N["a"])(X,i,s,!1,null,"1ef07d08",null));P.options.__file="searchEngine.vue";t["default"]=P.exports},"9b66":function(e,t,a){"use strict";var i=a("c070"),s=a.n(i);s.a},"9c18":function(e,t,a){"use strict";var i=a("2ab8"),s=a.n(i);s.a},bedf:function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"b",function(){return r}),a.d(t,"c",function(){return n}),a.d(t,"d",function(){return s});a("a481"),a("4917"),a("f751");var i=function(e){var t=JSON.stringify(e);return JSON.parse(t)},s=function e(t){for(var a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"parentId",n=[],r=0,l=t.length;r<l;r++)if(t[r][s]==i){var c=t[r];a=e(t,t[r].id,s),a.length>0&&(c.children=a),n.push(c)}return n},n=function e(t,a,i){for(var s,n=[],r=Object.assign({parentKey:"parentId",idKey:"id",childrenKey:"children"},a),l=0,c=t.length;l<c;l++)if(t[l][r.parentKey]==i){var o={};for(var h in r.map)o[r.map[h]]=t[l][h];s=e(t,a,t[l][r.idKey]),s.length>0&&(o[r.childrenKey]=s),n.push(o)}return n},r=function(e,t){var a=/\$\{\w+\}/,i=e.match(a);while(i){var s=i[0],n=t[s.replace(/\$\{(\w+)\}/,"$1")];e=e.replace(s,n),i=e.match(a)}return e}},c070:function(e,t,a){},cf1c:function(e,t,a){e.exports=a.p+"/static/img/loading.1ead16c1.gif"}}]);