(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f945"],{"354e":function(e,t,a){"use strict";var i=a("df64"),n=a.n(i);n.a},"386d":function(e,t,a){a("214f")("search",1,function(e,t,a){return[function(a){"use strict";var i=e(this),n=void 0==a?void 0:a[t];return void 0!==n?n.call(a,i):new RegExp(a)[t](String(i))},a]})},4917:function(e,t,a){a("214f")("match",1,function(e,t,a){return[function(a){"use strict";var i=e(this),n=void 0==a?void 0:a[t];return void 0!==n?n.call(a,i):new RegExp(a)[t](String(i))},a]})},"4c71":function(e,t,a){"use strict";var i=a("5122"),n=a.n(i);n.a},5122:function(e,t,a){},"6c2a":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"mainWrap"},[e.loading?i("section",{staticClass:"loading"},[i("div",{staticClass:"mask"}),i("img",{attrs:{src:a("cf1c")}})]):e._e(),i("section",{staticClass:"leftTree"},[i("div",{staticClass:"searchTree",on:{keypress:function(t){return"button"in t||13===t.keyCode?e.searchTree(t):null}}},[i("Input",{staticStyle:{width:"160px"},attrs:{placeholder:"请输入指标",size:"small"},model:{value:e.treeKeyWord,callback:function(t){e.treeKeyWord=t},expression:"treeKeyWord"}}),i("Button",{attrs:{type:"primary",icon:"ios-search",size:"small",shape:"circle"},on:{click:e.searchTree}})],1),i("Tree",{attrs:{data:e.nodes,"show-checkbox":""},on:{"on-check-change":e.checkNode}})],1),i("section",{staticClass:"rightMain"},[i("section",{staticClass:"filter"},[i("Icon",{staticClass:"showFilter",attrs:{type:"funnel",size:"24"},nativeOn:{click:function(t){return e.showFilter(t)}}}),e._l(e.filter.conditions,function(t,a){return i("i",{key:a,staticClass:"filter-act"},[e._v(e._s(e.formatCondition(t))+"\n                    "),i("Icon",{staticClass:"edit",attrs:{type:"edit",size:"12"},nativeOn:{click:function(a){e.editFilter(t.field)}}}),i("Icon",{staticClass:"close",attrs:{type:"close-round",size:"12"},nativeOn:{click:function(a){e.removeFilter(t.field)}}})],1)}),i("div",{staticClass:"item"},[i("em",[e._v("实时查询")]),i("i-switch",{staticStyle:{float:"left",margin:"3px 0 0 4px"},on:{"~on-change":function(t){return e.infoRealTime(t)}},model:{value:e.search.realTime,callback:function(t){e.$set(e.search,"realTime",t)},expression:"search.realTime"}},[i("Icon",{attrs:{slot:"open",type:"android-done"},slot:"open"}),i("Icon",{attrs:{slot:"close",type:"android-close"},slot:"close"})],1)],1),i("div",{staticClass:"item"},[i("em",[e._v("可视化")]),i("i-switch",{staticStyle:{float:"left",margin:"3px 0 0 4px"},on:{"~on-change":function(t){return e.adjust(t)}},model:{value:e.isShowChart,callback:function(t){e.isShowChart=t},expression:"isShowChart"}},[i("Icon",{attrs:{slot:"open",type:"android-done"},slot:"open"}),i("Icon",{attrs:{slot:"close",type:"android-close"},slot:"close"})],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.search.realTime,expression:"!search.realTime"}],staticClass:"item"},[i("Button",{attrs:{type:"primary",icon:"ios-search",shape:"circle"},on:{click:function(t){e.searchNow(1)}}},[e._v("查询")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.search.realTime,expression:"!search.realTime"}],staticClass:"item"},[i("Button",{attrs:{type:"ghost",icon:"trash-b",shape:"circle"},on:{click:e.forceUpdate}},[e._v("重置")])],1),i("div",{directives:[{name:"show",rawName:"v-show",value:e.table.data.length>0,expression:"table.data.length > 0"}],staticClass:"item"},[i("Button",{attrs:{type:"primary",icon:"document",shape:"circle"},on:{click:e.exportNow}},[e._v("导出")])],1)],2),e.filter.isShowFilter?[i("div",{staticClass:"filterMask",on:{click:e.closeFilter}}),i("section",{staticClass:"filterWrap",on:{keyup:function(t){return"button"in t||13===t.keyCode?e.saveFilter(t):null}}},[i("i",{staticClass:"arrow"}),i("h1",[e._v("选择过滤字段")]),i("div",{staticClass:"itemWrap"},[i("em",[e._v("字段")]),i("Select",{staticClass:"filterItem",staticStyle:{width:"160px"},attrs:{clearable:"",filterable:""},on:{"on-change":e.changeFilter},model:{value:e.filter.field,callback:function(t){e.$set(e.filter,"field",t)},expression:"filter.field"}},e._l(e.search.checkedNodes,function(t){return i("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],1),e.filter.field?i("section",{staticClass:"filterContent"},[i("div",{staticClass:"menu"},e._l(e.filter.filterTags,function(t,a){return i("i",{key:a,class:{act:t.act}},[e._v(e._s(t.name))])})),i("div",{staticClass:"settingWrap"},["value"===e.filter.openFilter?[i("div",{staticClass:"item"},[i("em",[e._v("操作符")]),i("Select",{staticStyle:{width:"120px"},attrs:{clearable:""},model:{value:e.filter.selectOper,callback:function(t){e.$set(e.filter,"selectOper",t)},expression:"filter.selectOper"}},e._l(e.filter.filters.value,function(t){return i("Option",{key:t.value,attrs:{value:t.value}},[e._v("\n                                        "+e._s(t.name)+"\n                                    ")])}))],1),i("div",{staticClass:"item"},[i("em",[e._v("数值")]),i("Input",{staticClass:"fill",model:{value:e.filter.minValue,callback:function(t){e.$set(e.filter,"minValue",t)},expression:"filter.minValue"}}),"between"===e.filter.selectOper?[i("em",{staticClass:"toText"},[e._v("-")]),i("Input",{staticClass:"fill",model:{value:e.filter.maxValue,callback:function(t){e.$set(e.filter,"maxValue",t)},expression:"filter.maxValue"}})]:e._e()],2)]:e._e(),"text"===e.filter.openFilter?[i("div",{staticClass:"item"},[i("em",[e._v("操作符")]),i("Select",{staticStyle:{width:"120px"},attrs:{clearable:""},model:{value:e.filter.selectOper,callback:function(t){e.$set(e.filter,"selectOper",t)},expression:"filter.selectOper"}},e._l(e.filter.filters.text,function(t){return i("Option",{key:t.value,attrs:{value:t.value}},[e._v("\n                                        "+e._s(t.name)+"\n                                    ")])}))],1),i("div",{staticClass:"item"},[i("em",[e._v("文本")]),i("Input",{staticClass:"fill",staticStyle:{width:"120px"},model:{value:e.filter.minValue,callback:function(t){e.$set(e.filter,"minValue",t)},expression:"filter.minValue"}})],1)]:e._e(),i("div",{staticClass:"item"},[i("em",[e._v(" ")]),i("Button",{attrs:{type:"primary"},on:{click:e.saveFilter}},[e._v("提交")])],1)],2)]):e._e()])]:e._e(),i("section",{staticClass:"resultWrap"},[i("transition",{attrs:{name:"fade"}},[e.isShowChart?i("section",{staticClass:"chartWrap"},[i("custom-echarts",{attrs:{fields:e.search.checkedNodes,echartData:e.chartData},on:{"on-need-search":e.loadEchartsData}})],1):e._e()]),e.table.data.length>0?i("section",{ref:"tableWrap",staticClass:"tableWrap"},[i("Table",{attrs:{columns:e.table.columns,data:e.table.data,size:"small",stripe:""},on:{"on-sort-change":e.sortTable}}),i("Page",{staticClass:"page",attrs:{total:e.table.page.total,"page-size":e.table.page.pageSize,"show-elevator":""},on:{"on-change":e.changePage}})],1):e._e()],1)],2)])},n=[],s=(a("20d6"),a("7f7f"),a("6762"),a("2fdb"),a("28a5"),a("7514"),a("f751"),a("a481"),a("386d"),a("c93e")),r=(a("ac6a"),a("cadf"),a("551c"),a("097d"),a("0db3")),c=a("f121"),o=a("ed08"),l=a("bedf"),h=(a("55dd"),a("a322")),u=a("8afe"),f=(a("6b54"),a("6bde"),{symbol:"path://M1233.329493 174.421333h-1112.064c-34.128213 0-61.781333 27.661653-61.781333 61.781334v473.658026c0 34.117973 27.65312 61.781333 61.781333 61.781334h472.80128l83.23072 144.155306 83.23072-144.155306h472.80128c34.128213 0 61.781333-27.66336 61.781334-61.781334V236.202667c0-34.117973-27.65312-61.781333-61.781334-61.781334z",symbolOffset:[0,"-50%"],label:{normal:{verticalAlign:"bottom",lineHeight:22}}}),d=function(e,t,a){var i=a.stack,n=a.subType,r={max:{belong:"markPoint",data:Object(s["a"])({type:"max",name:"最大值"},f)},min:{belong:"markPoint",data:Object(s["a"])({type:"min",name:"最小值"},f)},average:{belong:"markLine",data:{type:"average",name:"平均值",label:{normal:{show:!0,position:"middle"}}}}},c={},o=i?14:9;return e.forEach(function(e){var t=r[e];c[t.belong]||(c[t.belong]={data:[]}),c[t.belong].data.push(t.data)}),t.map(function(e){var t=Math.max.apply(Math,Object(u["a"])(e.data)).toString().length;return c.markPoint&&c.markPoint.data.forEach(function(e){e.symbolSize=[t*o,40],["Hbar","SHbar"].indexOf(n)>-1?(e.symbolRotate=-90,e.symbolOffset=["25%",0],e.label.normal.rotate=-90,e.itemStyle={normal:{borderColor:"#fff",borderWidth:2}}):(e.label.normal.rotate=0,e.itemStyle={})}),Object.assign(e,c),e})},p={area:["area"],xyReverse:["Hbar","SHbar"],rose:["rose"],circular:["circular"]},m=function(e,t,a){a.type,a.stack;var i=function(e,t,i){var n=i.axisX,s=i.axisY,r=i.type,c=i.stack,o=i.subType,l=i.markers,u=i.adjust,f={},m=[],g=[];e.forEach(function(e,a){var i=e[n];m.push(i),-1===m.indexOf(i)&&m.push(i),s.forEach(function(a){var i=t.find(function(e){return e.id===a.replace("col_","")});i&&(f[i.name]||(f[i.name]=Object(h["a"])({},e[c],{})),f[i.name][e[c]]?f[i.name][e[c]][e[n]]?f[i.name][e[c]][e[n]]+=e[a]:f[i.name][e[c]][e[n]]=e[a]:f[i.name][e[c]]=Object(h["a"])({},e[n],e[a]))})});var v=function(e){var t=function(t){var a={name:t,stack:e,type:r,data:m.map(function(a){return f[e][t][a]||0})};u.labelPosition&&(a.label={show:!0,position:u.labelPosition}),g.push(a)};for(var a in f[e])t(a)};for(var b in f)v(b);var y={title:"",series:l.length>0?d(l,g,a):g};return p.xyReverse.indexOf(o)>-1?Object.assign(y,{xAxis:{type:"value"},yAxis:{type:"category",data:m}}):y.axisX=m,y},n=function(e,t,i){var n=i.axisX,s=i.axisY,r=i.type,c=i.subType,o=i.markers,l=i.adjust,h=[],u=[];e.forEach(function(e,a){var i=e[n];h.push(i),s.forEach(function(i){if(0===a){var n=t.find(function(e){return e.id===i.replace("col_","")}),s={name:n.name,id:i,data:[],type:r};l.labelPosition&&(s.label={show:!0,position:l.labelPosition}),u.push(s)}var c=u.find(function(e){return e.id===i});c.data.push(e[i])})});var f={title:"",series:o.length>0?d(o,u,a):u};return p.area.indexOf(c)>-1&&u.map(function(e){return e.areaStyle={normal:{}},e}),p.xyReverse.indexOf(c)>-1?Object.assign(f,{xAxis:{type:"value"},yAxis:{type:"category",data:h}}):(f.axisX=h,l.rotate&&(f.xAxis={axisLabel:{rotate:l.rotate}})),f},s=function(e,t,a){var i=a.axisX,n=a.axisY,s=a.type,r=a.subType,c=[],o=[];return e.forEach(function(e,a){var l=e[i];c.push(l),n.forEach(function(i){if(0===a){var n=t.find(function(e){return e.id===i.replace("col_","")});o.push({name:n.name,id:i,data:[],type:s,label:{formatter:"{b}：共{c}，占{d}%"}})}var c=o.find(function(e){return e.id===i});c.data.push({name:l,value:e[i]}),p.circular.indexOf(r)>-1&&(c.radius=["30%","70%"]),p.rose.indexOf(r)>-1&&(c.roseType="radius")})}),{legend:{data:c},type:"pie",title:"",series:o}},r=function(e){var t={bar:n,line:n,pie:s,Sbar:e.stack?i:n,Hbar:n,SHbar:e.stack?i:n,area:n,circular:s,rose:s};return t[e.subType]};return r(a)(e,t,a)},g=function(e){var t=e.fields,a=e.page,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=t.filter(function(e){return null!==e.refField}).map(function(e){return e.refField}),r=t.filter(function(e){return-1===s.indexOf(e.fieldName)}).map(function(e){var t={title:e.fieldCnName,key:e.fieldName,fieldAttr:parseInt(e.fieldAttr)};return n&&i[e[n]]&&Object.assign(t,i[e[n]]),t.hasOwnProperty("align")||(t.align="center",t.sortable="custom"),t});return r.sort(function(e,t){return e.fieldAttr>t.fieldAttr?1:e.fieldAttr<t.fieldAttr?-1:0}),{columns:r,data:a.list,page:{pageSize:a.pageSize,total:a.total,pages:a.pages}}},v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"echartsWrap"},[a("Icon",{staticClass:"hideBtn",attrs:{type:e.echartsConfig.maxEchart?"gear-b":"close-circled"},nativeOn:{click:function(t){return e.toggleConfig(t)}}}),a("transition",{attrs:{name:"fade-left"},on:{"after-leave":e.finishTransition,"after-enter":e.finishTransition}},[e.echartsConfig.maxEchart?e._e():a("div",{staticClass:"echartsConfig"},[a("div",{staticClass:"typeList"},e._l(e.echartsConfig.typeIcoList,function(t){return a("Tooltip",{key:t.subType,staticClass:"ico",class:{"ico-checked":t.checked},attrs:{content:t.name,delay:1e3},nativeOn:{click:function(a){e.checkChartType(t.type,t.subType)}}},[a("img",{key:t.subType,attrs:{src:"static/svg/"+t.icon}})])})),a("div",{staticClass:"itemLi"},[a("em",[e._v("维度")]),a("Select",{staticClass:"fill",attrs:{clearable:""},on:{"on-change":e.changeXAxis},model:{value:e.echartsConfig.axisX,callback:function(t){e.$set(e.echartsConfig,"axisX",t)},expression:"echartsConfig.axisX"}},e._l(e.echartsConfig.axisXList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.name))])})),a("Icon",{staticClass:"icon",attrs:{type:"ios-settings-strong"}})],1),a("div",{staticClass:"itemLi"},[a("em",[e._v("量度")]),a("Select",{staticClass:"fill",attrs:{multiple:"",clearable:""},on:{"on-change":e.changeYAxis},model:{value:e.echartsConfig.axisY,callback:function(t){e.$set(e.echartsConfig,"axisY",t)},expression:"echartsConfig.axisY"}},e._l(e.echartsConfig.axisYList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.name))])}))],1),a("transition",{attrs:{name:"fade"}},[e.echartsConfig.needStack.includes(e.echartsConfig.subType)?a("div",{staticClass:"itemLi"},[a("em",[e._v("分组")]),a("Select",{staticClass:"fill",attrs:{clearable:""},on:{"on-change":e.loadChart},model:{value:e.echartsConfig.stack,callback:function(t){e.$set(e.echartsConfig,"stack",t)},expression:"echartsConfig.stack"}},e._l(e.echartsConfig.stackList,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v("\n                            "+e._s(t.name)+"\n                        ")])}))],1):e._e()]),a("transition",{attrs:{name:"fade"}},[e.echartsConfig.needMarkers.includes(e.echartsConfig.subType)?a("div",{staticClass:"itemLi",staticStyle:{height:"auto"}},[a("em",[e._v("标记")]),a("CheckboxGroup",{staticClass:"fill",on:{"on-change":e.changeMarkers},model:{value:e.echartsConfig.markers,callback:function(t){e.$set(e.echartsConfig,"markers",t)},expression:"echartsConfig.markers"}},[a("Checkbox",{attrs:{label:"max"}},[e._v("最大值")]),a("Checkbox",{attrs:{label:"min"}},[e._v("最小值")]),a("Checkbox",{attrs:{label:"average"}},[e._v("平均值")])],1)],1):e._e()])],1)]),a("div",{staticClass:"echartsResult",class:{fullfill:e.echartsConfig.maxEchart}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"}],staticClass:"empty"},[e._v("请先进行配置")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"chart",attrs:{id:"chart"}})])],1)},b=[],y=(a("96cf"),a("3040"));function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function k(e,t,a){return t&&x(e.prototype,t),a&&x(e,a),e}var w=a("7c9b"),O=a("313e"),_=a.n(O),S=function(){function e(t){for(var a in C(this,e),this.color=["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],this.globalConfigs={theme:!1,map:!1,common:{title:{left:"center"},legend:{bottom:10},toolbox:{show:!0,feature:{saveAsImage:{title:"保存"}}}}},t)if("common"===a)for(var i in t.common)this.globalConfigs.common[i]&&"[object Object]"===Object.prototype.toString.call(t[i])?Object.assign(this.globalConfigs.common[i],t.common[i]):this.globalConfigs.common[i]=t.common[i];else this.globalConfigs[a]&&"[object Object]"===Object.prototype.toString.call(t[a])?Object.assign(this.globalConfigs[a],t[a]):this.globalConfigs[a]=t[a];this.echartsConfig=null,this.charts={},this.eventBinded=!1,this.theme=null,this.mapData=null}return k(e,[{key:"createEcharts",value:function(e,t){this.theme&&!this.charts[e]?this.charts[e]=_.a.init(document.getElementById(e),"customTheme"):this.charts[e]||(this.charts[e]=_.a.init(document.getElementById(e)));var a=Object(w["a"])(this.globalConfigs.common);for(var i in a)t[i]?"[object Object]"===Object.prototype.toString.call(t[i])&&(t[i]=Object.assign({},a[i],t[i])):t[i]=a[i];this.charts[e].setOption(t)}},{key:"load",value:function(){var e=Object(y["a"])(regeneratorRuntime.mark(function e(t){var i,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!0!==this.globalConfigs.theme||this.theme){e.next=5;break}return e.next=3,a.e("theme").then(a.t.bind(null,"a7d6",3)).then(function(e){n.theme=e,_.a.registerTheme("customTheme",e)});case 3:e.next=6;break;case 5:!1===this.globalConfigs.theme&&(this.globalConfigs.common.color=this.color);case 6:if(!this.globalConfigs.map||this.map){e.next=9;break}return e.next=9,a("7773")("./".concat(this.globalConfigs.map,".json")).then(function(e){n.map=e,_.a.registerMap(n.globalConfigs.map,e)});case 9:for(i in t)this.charts[i]&&this.charts[i].clear(),this.createEcharts(i,t[i]);return this.eventBinded||window.addEventListener("resize",function(){n.resize()},!1),e.abrupt("return",this);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"clear",value:function(){for(var e in this.charts)this.charts[e].clear();return this}},{key:"getInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?this.charts[e]:this.charts}},{key:"resize",value:function(){for(var e in this.charts)this.charts[e].resize();return this}},{key:"getColor",value:function(e){return e?this.color[e]:this.color}},{key:"getEchart",value:function(){return _.a}},{key:"dispose",value:function(){for(var e in this.charts)this.charts[e].dispose()}}]),e}(),T={data:function(){return{$chart:null,echartsConfig:{typeList:{bar:"柱状图",line:"折线图",pie:"饼图"},needStack:["Sbar","SHbar"],needMarkers:["bar","Hbar","Sbar","SHbar","line","area"],markers:[],typeIcoList:[{name:"柱状图",type:"bar",icon:"bar.svg",subType:"bar",checked:!0},{name:"横向柱状图",type:"bar",icon:"Hbar.svg",subType:"Hbar",checked:!1},{name:"堆叠柱状图",type:"bar",icon:"Sbar.svg",subType:"Sbar",checked:!1},{name:"横向堆叠柱状图",type:"bar",icon:"SHbar.svg",subType:"SHbar",checked:!1},{name:"折线图",type:"line",icon:"line.svg",subType:"line",checked:!1},{name:"面积图",type:"line",icon:"area.svg",subType:"area",checked:!1},{name:"饼图",type:"pie",icon:"pie.svg",subType:"pie",checked:!1},{name:"环形图",type:"pie",icon:"circular.svg",subType:"circular",checked:!1},{name:"南丁格尔图",type:"pie",icon:"rose.svg",subType:"rose",checked:!1}],maxEchart:!1,subType:"bar",type:"bar",axisY:[],axisYList:[],axisX:null,axisXList:[],stack:null,stackList:[],sum:[],sumList:[]},isShow:!1}},props:{fields:{type:Array,default:function(){return[]}},echartData:{type:Array,default:function(){return[]}}},watch:{fields:function(){this.updateConfig(),this.reset()},echartData:function(){this.loadChart()}},methods:{reset:function(){this.$chart.clear(),Object.assign(this.echartsConfig,{axisX:null,axisY:[],stack:null,sum:[]})},finishTransition:function(){var e=this;window.setTimeout(function(){e.$chart.resize()},200)},checkChartType:function(e,t){var a=this.echartsConfig.typeIcoList.find(function(e){return e.subType===t});if(a){var i=this.echartsConfig.typeIcoList.find(function(e){return!0===e.checked});i&&(i.checked=!1),a.checked=!0,this.echartsConfig.type=e,this.echartsConfig.subType=t,this.loadChart()}},changeMarkers:function(e){this.loadChart()},toggleConfig:function(){this.echartsConfig.maxEchart=!this.echartsConfig.maxEchart},updateConfig:function(){if(!this.fields||0===this.fields.length)return!1;var e=[],t=[],a=[],i=[];this.fields.forEach(function(n){var s=parseInt(n.attr,10),r={value:-1===n.id.indexOf("col_")?"col_"+n.id:n.id,name:n.name};switch(s){case 0:e.push(r),a.push(r);break;case 1:t.push(r),i.push(r);break}}),Object.assign(this.echartsConfig,{axisXList:e,axisYList:t,stackList:a,sumList:i})},changeYAxis:function(e){var t=!1;"pie"===this.echartsConfig.type&&e.length>1&&(t=!0,this.echartsConfig.axisY=[e[1]]),t||this.loadChart(!0)},changeXAxis:function(e){this.loadChart(!0)},loadChart:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.echartsConfig,a=t.axisX,i=t.axisY,n=t.type;if(a&&0!==i.length){if(!n)return this.$Message.info("请先选择图形类型！"),!1;if(e||!this.echartData||0===this.echartData.length){var s=i.find(function(e){return e.indexOf("c80fbdf0a4eb11e7988555a026dee4dc")>-1})?[]:[a].concat(Object(u["a"])(i));return this.$emit("on-need-search",s),!1}this.isShow=!0;var r=m(this.echartData,this.fields,this.echartsConfig);r.series.length>0&&(Object.assign(r,{toolbox:{show:!0,feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},saveAsImage:{}}}}),this.echartData.length>1e3?this.$Modal.error({title:"系统提示",content:"当前查询到".concat(this.echartData.length,"条数据，进行可视化会导致系统缓慢或崩溃!")}):this.$nextTick(function(){this.$chart.load({chart:r})}))}else this.$chart.clear(),this.isShow=!1}},created:function(){this.$chart=new S({backgroundColor:"#fff",trigger:"axis",grid:{top:40,bottom:60,left:"12%",right:"2%"}}),this.updateConfig()}},j=T,N=(a("354e"),a("2877")),E=Object(N["a"])(j,v,b,!1,null,"f4628f12",null);E.options.__file="CustomEcharts.vue";var I=E.exports,$=c["b"].API,F=c["b"].nodeConfig,V=c["b"].filterCondition,L={data:function(){return{table:{columns:[],data:[]},isShowChart:!1,loading:!1,chartData:[],filter:{field:null,isShowFilter:!1,filters:"",filterTags:[],selectOper:"",minValue:"",maxValue:"",conditions:[],openFilter:null,orderBy:[]},treeKeyWord:null,nodes:[],search:{checkedNodes:[],lock:!0,realTime:!1,allCondition:null,errorMessage:null},page:{pageSize:15,pageNum:1}}},components:{Tree:r["a"],CustomEcharts:I},computed:{searchParams:function(){var e=[];return this.filter.conditions.forEach(function(t){"between"===t.selectOper?e.push({attr:t.attr,col:t.field,value:t.minValue,oper:"ge"},{attr:t.attr,col:t.field,value:t.maxValue,oper:"le"}):e.push({attr:t.attr,col:t.field,value:t.minValue,oper:t.selectOper})}),Object(s["a"])({fields:this.search.checkedNodes.map(function(e){return e.id}).join(",")},e.toUrlParmas("conditions"),this.filter.orderBy.toUrlParmas("orders"))}},methods:{forceUpdate:function(){location.reload()},adjust:function(){this.table.columns=this.table.columns.map(function(e){return e})},infoRealTime:function(){var e=this;this.$Modal.info({title:"温馨提示",content:"在数据量较大的情况下实时查询频繁查询会影响查询效率"}),window.setTimeout(function(){e.$Modal.remove()},5e3)},sortTable:function(e){e.column;var t=e.key,a=e.order;this.filter.orderBy=[{col:t.replace("col_",""),order:a}],this.searchNow(2)},loadEchartsData:function(e){var t=this;this.loading=!0;var a=Object(s["a"])({},this.searchParams);e&&e.length>0&&(a["subQuery.fields"]=e.join(",").replace(/col_/g,"")),this.$http({url:$.searchAll,method:"post",data:a}).then(function(e){var a=e.data;if(t.loading=!1,!0===a.success){var i=a.result;t.chartData=i.data}})},checkNode:function(e){var t=[],a=!1,i=!1,n=[];e.forEach(function(e){e.children&&0!==e.children.length||(t.push(e),0===parseInt(e.attr)&&(i=!0),1===parseInt(e.attr)&&(a=!0),-1===n.indexOf(e.subjectId)&&null!==e.subjectId&&n.push(e.subjectId))}),this.search.checkedNodes=t,a&&i?n.length>1?Object.assign(this.search,{lock:!0,errorMessage:"所选的字段不能进行联表查询！"}):this.search.lock=!1:Object.assign(this.search,{lock:!0,errorMessage:"必须同时选择维度和量度才能进行查询！"}),this.searchNow()},showFilter:function(){this.search.checkedNodes.length>0?this.filter.isShowFilter=!0:this.$Message.warning("您没有选择任何查询字段，请先在左侧的树中勾选字段！")},closeFilter:function(){this.filter.isShowFilter=!1,this.resetFilter()},changeFilter:function(e){var t=this,a=this.search.checkedNodes.find(function(t){return t.id===e}),i=this.filter.conditions.find(function(e){return e.field===t.filter.field}),n=!1,r=!1;if(a){this.filter.filterTags=[];var c=a.conditionOper.split(","),o=[],l={};c.includes("gt")&&(o.push({type:"value",name:V.value.name}),l.value=V.value.list,n=!0),c.includes("like")&&(o.push({type:"text",name:V.text.name}),l.text=V.text.list,r=!0),o.length>0&&!o.some(function(e){return!0===e.act})&&(o[0].act=!0),r&&n||n?this.filter.openFilter="value":r&&(this.filter.openFilter="text"),Object.assign(this.filter,{filters:l,filterTags:o})}i?(this.filter.selectOper=null,Object.assign(this.filter,i)):this.filter=Object(s["a"])({},this.filter,{selectOper:null,minValue:null,maxValue:null})},resetFilter:function(){this.filter=Object(s["a"])({},this.filter,{selectOper:null,minValue:null,maxValue:null,field:null})},saveFilter:function(){var e=this,t=this.filter.conditions.findIndex(function(t){return t.field===e.filter.field}),a=null;if(this.filter.selectOper?"between"!==this.filter.selectOper||this.filter.minValue||this.filter.minValue?this.filter.minValue||(a="数值不能为空！"):a="选择区间必须填写最大最小值！":a="操作符必选！",null!==a)return this.$Modal.error({title:"系统提示",content:a}),!1;var i=this.search.checkedNodes.find(function(t){return t.id===e.filter.field}),n={field:this.filter.field,name:i.name,selectOper:this.filter.selectOper,minValue:this.filter.minValue,maxValue:this.filter.maxValue,template:V.template[this.filter.selectOper],attr:i.attr};-1===t?this.filter.conditions.push(n):this.filter.conditions[t]=n,this.closeFilter(),this.searchNow(1)},formatCondition:function(e){var t=e.template,a=e.name,i=e.minValue,n=e.maxValue;return Object(l["b"])(t,{name:a,minValue:i,maxValue:n})},removeFilter:function(e){this.filter.conditions=this.filter.conditions.filter(function(t){return t.field!==e}),this.searchNow(1)},editFilter:function(e){var t=this.filter.conditions.find(function(t){return t.field===e});Object.assign(this.filter,t),this.filter.isShowFilter=!0},searchNow:function(e){var t=this;if(!1===this.search.realTime&&!e)return!1;if(0===this.search.checkedNodes.length)return this.$Message.warning("您没有选择任何查询字段，请先在左侧的树中勾选字段！"),!1;if(this.search.lock)return this.$Modal.error({title:"系统提示",content:this.search.errorMessage}),!1;var a=JSON.stringify(this.searchParams),i=this.search.allCondition;if(2===e||a!==i){var n=this.$http;this.loading=!0,n({url:$.search,method:"post",data:Object(s["a"])({},this.searchParams,{"page.pageSize":this.page.pageSize,"page.pageNum":this.page.pageNum})}).then(function(e){var a=e.data,i=a.result;t.loading=!1,!0===a.success&&(t.search.allCondition=JSON.stringify(t.searchParams),Object.assign(t.table,g(i)))}),this.isShowChart&&this.loadEchartsData()}},changePage:function(e){this.page.pageNum=e,this.searchNow(2)},exportNow:function(){Object(o["a"])($.exportNow,{data:this.searchParams})},searchTree:function(){var e=this;if(this.treeKeyWord.length>=1){var t=[];if(this.nodes.forEach(function(a){a.selected=!1,a.expand=!1,a.name.indexOf(e.treeKeyWord)>-1&&(t.push(a),a.selected=!0)}),0===t.length)return this.$Modal.info({title:"系统提示",closable:!0,content:"未找到关键字为“".concat(this.treeKeyWord,"”的字段。")}),!1;t.forEach(function(t){var a=t.parentId;while("0"!=a){var i=e.nodes.find(function(e){return e.id===a});i&&(i.expand=!0),a=i.parentId}}),this.nodes=this.nodes.map(function(e){return e})}}},created:function(){var e=this;this.$http({url:$.getTreeNodes,method:"post"}).then(function(t){var a=t.data;if(!0===a.success){var i=[];a.result.forEach(function(e){F[e.attr]&&(e.icon=F[e.attr].icon),i.push(e)}),e.nodes=i}})}},M=L,A=(a("4c71"),Object(N["a"])(M,i,n,!1,null,"c784c63e",null));A.options.__file="searchEngine.vue";t["default"]=A.exports},7773:function(e,t,a){var i={"./dongguan.json":["e0a6","dongguan0"],"./dongguanForBaiduMap.json":["055f","055f"]};function n(e){var t=i[e];return t?a.e(t[1]).then(function(){var e=t[0];return a.t(e,3)}):Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}n.keys=function(){return Object.keys(i)},n.id="7773",e.exports=n},bedf:function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"b",function(){return r}),a.d(t,"c",function(){return s}),a.d(t,"d",function(){return n});a("a481"),a("4917"),a("f751");var i=function(e){var t=JSON.stringify(e);return JSON.parse(t)},n=function e(t){for(var a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"parentId",s=[],r=0,c=t.length;r<c;r++)if(t[r][n]==i){var o=t[r];a=e(t,t[r].id,n),a.length>0&&(o.children=a),s.push(o)}return s},s=function e(t,a,i){for(var n,s=[],r=Object.assign({parentKey:"parentId",idKey:"id",childrenKey:"children"},a),c=0,o=t.length;c<o;c++)if(t[c][r.parentKey]==i){var l={};for(var h in r.map)l[r.map[h]]=t[c][h];n=e(t,a,t[c][r.idKey]),n.length>0&&(l[r.childrenKey]=n),s.push(l)}return s},r=function(e,t){var a=/\$\{\w+\}/,i=e.match(a);while(i){var n=i[0],s=t[n.replace(/\$\{(\w+)\}/,"$1")];e=e.replace(n,s),i=e.match(a)}return e}},cf1c:function(e,t,a){e.exports=a.p+"img/loading.1ead16c1.gif"},df64:function(e,t,a){}}]);